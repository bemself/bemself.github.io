<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.1.22" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>python/Linear-Regression-impl: My Struggle â€” Life goes on...</title>
</head>
<body class="tc-body">

<section class="tc-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists " data-tags="" data-tiddler-title="python/Linear-Regression-impl"><div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><span class=" tc-reveal"><button aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span></span><span><span class="tc-tiddler-title-icon" style="fill:;"></span><h2 class="tc-title">python/Linear-Regression-impl</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-missing" href=".html"></a>26th July 2020</div></div><div class=" tc-reveal">
<div class="tc-tags-wrapper"></div>
</div>

<div class="tc-tiddler-body tc-reveal"><hr><p>title: Python - çº¿æ€§å›å½’ï¼ˆLinear Regression) çš„ Python å®ç°<br>date: 2020-01-14<br>edit: 2020-01-14<br>layout: post<br>status: Completed<br>categories:</p><ul><li><p>Python<br>tags:</p></li><li><p>Python<br>description:  åœ¨ Python ä¸­å¦‚ä½•å®ç°çº¿æ€§å›å½’ï¼Ÿå¾ˆç®€å•ï¼Œæœ‰ä¸é”™çš„åŒ…å’Œå‡½æ•°~</p></li></ul><hr><h1>èƒŒæ™¯</h1><p>å­¦ä¹  <a href="https://realpython.com/linear-regression-in-python/" target="_blank">Linear Regression in Python â€“ Real Python</a>ï¼Œå‰é¢å‡ ç¯‡æ–‡ç« åˆ†åˆ«è®²äº†â€œregressionæ€ä¹ˆç†è§£â€œï¼Œâ€çº¿æ€§å›å½’æ€ä¹ˆç†è§£â€œï¼Œç°åœ¨è¯¥æ˜¯å®ç°çš„æ—¶å€™äº†ã€‚</p><h1>çº¿æ€§å›å½’çš„ Python å®ç°ï¼šåŸºæœ¬æ€è·¯</h1><ul><li><p>å¯¼å…¥ Python åŒ…: æœ‰å“ªäº›åŒ…æ¨èå‘¢ï¼Ÿ</p><ul><li><p><code>Numpy</code>ï¼šæ•°æ®æº</p></li><li><p><a href="https://scikit-learn.org/stable/" target="_blank"><code>scikit-learn</code></a>ï¼šML</p></li><li><p><a href="https://www.statsmodels.org/stable/index.html" target="_blank"><code>statsmodels</code></a>: æ¯” <code>scikit-learn</code> åŠŸèƒ½æ›´å¼ºå¤§</p></li></ul></li><li><p>å‡†å¤‡æ•°æ®</p></li><li><p>å»ºæ¨¡æ‹Ÿåˆ</p></li><li><p>éªŒè¯æ¨¡å‹çš„æ‹Ÿåˆåº¦</p></li><li><p>é¢„æµ‹ï¼šç”¨æ¨¡å‹æ¥é¢„æµ‹æ–°çš„æ•°æ®</p></li></ul><h1>å®ç°ç»†èŠ‚</h1><p>ä»¥æœ€ç®€å•çš„çº¿æ€§å›å½’ä¸ºä¾‹ï¼Œä»£ç å‚è€ƒçš„æ˜¯åŸæ–‡ã€‚</p><p>é‡ç‚¹æ˜¯æŒæ¡åŸºæœ¬æ€è·¯ï¼Œä»¥åŠå…³é”®çš„å‡ ä¸ªå‡½æ•°ã€‚å½±å“æ‹Ÿåˆåº¦çš„å› ç´ å¾ˆå¤šï¼Œæ•°æ®æºé¦–å½“å…¶å†²ï¼Œæ¨¡å‹çš„é€‰æ‹©ä¹Ÿæ˜¯å…³é”®ï¼Œè¿™äº›åœ¨å®é™…åº”ç”¨ä¸­å…·ä½“è®¨è®ºï¼Œè¿™é‡Œå°±ç®€å•çš„å¯¹åº”å‰é¢çš„åŸºæœ¬æ€è·¯å°† sample ä»£ç åŠè¿è¡Œç»“æœè´´ä¸€ä¸‹ï¼Œç¨åŠ è§£é‡Šã€‚</p><h2>å®‰è£…å¹¶å¯¼å…¥åŒ…</h2><p>æ ¹æ®è‡ªå·±çš„éœ€è¦å¯¼å…¥</p><pre><code>pip install scikit-learn
pip install numpy
pip install statsmodels

from sklearn.preprocessing import PolynomialFeatures
import numpy as np
from sklearn.linear_model import LinearRegression
import statsmodels.api as sm
</code></pre><h2>å‡†å¤‡æ•°æ®</h2><p>&quot;&quot;&quot; prepare data<br>x: regressor<br>y: predictor<br>reshape: make it two dimentional - one column and many rows<br>y can also be 2 dimensional<br>&quot;&quot;&quot;</p><pre><code>x = np.array([5, 15, 25, 35, 45, 55]).reshape((-1, 1))
&quot;&quot;&quot;
[[ 5]
 [15]
 [25]
 [35]
 [45]
 [55]] 
&quot;&quot;&quot;
y = np.array([5, 20, 14, 32, 22, 38])
print(x, y)
# [ 5 20 14 32 22 38]
</code></pre><h2>å»ºæ¨¡</h2><pre><code>'''create a model and fit it'''
model = LinearRegression()
model = model.fit(x, y)
print(model)
# LinearRegression(copy_X=True, fit_intercept=True, n_jobs=None, normalize=False)
</code></pre><h2>éªŒè¯æ¨¡å‹çš„æ‹Ÿåˆåº¦</h2><pre><code>'''get result
y = b0 + b1x
'''
r_sq = model.score(x, y)
print('coefficient of determination(ğ‘…Â²) :', r_sq)
# coefficient of determination(ğ‘…Â²) : 0.715875613747954
print('intercept:', model.intercept_)
# ï¼ˆæ ‡é‡ï¼‰ ç³»æ•°b0 intercept: 5.633333333333329 -------this will be an array when y is also 2-dimensional
print('slope:', model.coef_)
# ï¼ˆæ•°ç»„ï¼‰æ–œç‡b1 slope: [0.54]        ---------this will be 2-d array when y is also 2-dimensional
</code></pre><h2>é¢„æµ‹</h2><pre><code>'''predict response
given x, get y from the model y = b0+b1x
'''
y_pred = model.predict(x)
print('predicted response:', y_pred, sep='\n')
#predicted response:
#[8.33333333 13.73333333 19.13333333 24.53333333 29.93333333 35.33333333]

'''forecast'''
z = np.arange(5).reshape((-1, 1))
y = model.predict(z)
print(y)
#[5.63333333 6.17333333 6.71333333 7.25333333 7.79333333]
</code></pre><h1>é—®é¢˜</h1><h1>Reference</h1><ul><li><p><a href="https://realpython.com/linear-regression-in-python/" target="_blank">Linear Regression in Python â€“ Real Python</a></p></li></ul><h1>Changelog</h1><ul><li><p>2020-01-14 init</p></li></ul></div>



</div>

</p>
</section>
</body>
</html>
