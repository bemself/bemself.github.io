<!doctype html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html;charset=utf-8" />
<meta name="generator" content="TiddlyWiki" />
<meta name="tiddlywiki-version" content="5.1.22" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent" />
<meta name="mobile-web-app-capable" content="yes"/>
<meta name="format-detection" content="telephone=no">
<link id="faviconLink" rel="shortcut icon" href="favicon.ico">
<link rel="stylesheet" href="static.css">
<title>python/statistics-basics: My Struggle — Life goes on...</title>
</head>
<body class="tc-body">

<section class="tc-story-river">
<p><div class="tc-tiddler-frame tc-tiddler-view-frame tc-tiddler-exists " data-tags="" data-tiddler-title="python/statistics-basics"><div class="tc-tiddler-title"><div class="tc-titlebar"><span class="tc-tiddler-controls"><span class=" tc-reveal"><button aria-label="more" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fmore-tiddler-actions" title="More actions"></button><div class=" tc-reveal" hidden="true"></div></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="edit" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fedit" title="Edit this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal"><button aria-label="close" class="tc-btn-invisible tc-btn-%24%3A%2Fcore%2Fui%2FButtons%2Fclose" title="Close this tiddler"></button></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span><span class=" tc-reveal" hidden="true"></span></span><span><span class="tc-tiddler-title-icon" style="fill:;"></span><h2 class="tc-title">python/statistics-basics</h2></span></div><div class="tc-tiddler-info tc-popup-handle tc-reveal" hidden="true"></div></div><div class=" tc-reveal" hidden="true"></div>
<div class=" tc-reveal"><div class="tc-subtitle"><a class="tc-tiddlylink tc-tiddlylink-missing" href=".html"></a>26th July 2020</div></div><div class=" tc-reveal">
<div class="tc-tags-wrapper"></div>
</div>

<div class="tc-tiddler-body tc-reveal"><hr><p>title: Python 统计基础<br>date: 2020-01-02<br>edit: 2020-01-02<br>layout: post<br>status: Completed<br>categories:</p><ul><li><p>Python<br>tags:</p></li><li><p>Python<br>description:  几个统计相关的 python 模块工具，以及可视化。</p></li></ul><hr><h1>背景</h1><p>在 <a href="http://weekly.pychina.org/issue/issue-399.html" target="_blank">Issue 399 ~蠎周刊 ~汇集全球蠎事儿 ;-)</a>上看到 <a href="https://realpython.com/python-statistics/" target="_blank">Python Statistics Fundamentals: How to Describe Your Data – Real Python</a>，挺感兴趣，以后或许会用到，所以跟着学了一下。</p><p>文章介绍的很详细，有具体的代码，没有完全跟着做下来，部分代码见<a href="https://github.com/bemself/exercise/tree/master/python/statistics" target="_blank">exercise/python/statistics</a>。</p><p>本文主要拎一些基本概念，应用场景，比较等。</p><h1>小结</h1><h2>介绍了描述性统计的几种方法：</h2><h3>同一数据集内：</h3><ul><li><p>central tendency：就是通常我们说的平均，描述数据的居中趋势</p></li><li><p>variability：描述数据的分布情况</p><ul><li><p>Variance： 方差</p></li><li><p>Standard deviation：标准差 = 方差的平方根</p><ul><li><p>数据离中心（平均数）有多远（求平均）</p></li></ul></li><li><p>Skewness：偏斜度</p><ul><li><p>数据整体偏移情况</p></li></ul></li><li><p>Percentiles：百分位数</p><ul><li><p>计算有 p% 的数少于等于某个值</p></li></ul></li><li><p>Ranges：范围</p><ul><li><p>这个比较简单，即 最大值 与 最小值的差</p></li></ul></li></ul></li><li><p>visuability: 可视化上面这些量化后的数据</p></li></ul><h3>不同数据集间：相关性</h3><ul><li><p>正相关</p></li><li><p>负相关</p></li><li><p>弱相关</p></li></ul><p>两个主要统计量：</p><ul><li><p>covariance：协方差</p></li><li><p>correlation coefficient：相关系数</p></li></ul><p>这两个目前我理解起来还有点困难，待以后补</p><p>找到一篇据说是很不错的解释协方差的文章：<a href="http://blog.sina.com.cn/s/blog_672c5a470100miqq.html" target="_blank">关于协方差矩阵的概念及意义</a>, 待看。</p><h2>介绍了 4 个 统计相关的 python 模块/包：</h2><ul><li><p>python 原生：自己写代码，套数学公式</p></li><li><p>python 自带：<a href="https://docs.python.org/3/library/statistics.html" target="_blank">statistics</a></p><ul><li><p><a href="https://docs.python.org/3/library/statistics.html" target="_blank">official documentation</a></p></li></ul></li><li><p><a href="https://docs.scipy.org/doc/numpy/user/index.html" target="_blank"><a class="tc-tiddlylink tc-tiddlylink-missing" href="NumPy.html">NumPy</a></a>：</p><ul><li><p>基本数据类型：<a href="https://docs.scipy.org/doc/numpy/reference/arrays.ndarray.html" target="_blank">ndarray</a></p></li><li><p>常用方法：<a href="https://docs.scipy.org/doc/numpy/reference/routines.statistics.html" target="_blank">Statistics — <a class="tc-tiddlylink tc-tiddlylink-missing" href="NumPy.html">NumPy</a> v1.17 Manual</a></p></li><li><p><a href="https://docs.scipy.org/doc/numpy/user/index.html" target="_blank">User Guide</a></p></li><li><p><a href="https://realpython.com/linear-regression-in-python/#" target="_blank">Click here to get access to a free <a class="tc-tiddlylink tc-tiddlylink-missing" href="NumPy.html">NumPy</a> Resources Guide</a></p></li></ul></li><li><p><a href="https://www.scipy.org/getting-started.html" target="_blank"><a class="tc-tiddlylink tc-tiddlylink-missing" href="SciPy.html">SciPy</a></a>：基于 Numpy 并扩展</p></li><li><p><a href="https://pandas.pydata.org/pandas-docs/stable/" target="_blank">Pandas</a>：基于 Numpy 并扩展</p><ul><li><p>一维数据对象：<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.html" target="_blank">Series</a></p></li><li><p>二维数据对象：<a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.DataFrame.html" target="_blank"><a class="tc-tiddlylink tc-tiddlylink-missing" href="DataFrame.html">DataFrame</a></a></p></li><li><p><a href="https://pandas.pydata.org/pandas-docs/stable/getting_started/index.html" target="_blank">official Getting Started page</a></p></li></ul></li></ul><p><strong>这么多包怎么选：</strong></p><ul><li><p>小数据集、或不想不能依赖其他包：自带 statistics</p></li><li><p>数据集带标签(labelled，即有 headers)，选 pandas，否则 scipy 或 numpy</p></li><li><p>scipy 比 numpy 的功能更多一些，比如 describe()方法等</p></li><li><p>数据集中多包含 nan 数据，那选 pandas，它对包含 <a class="tc-tiddlylink tc-tiddlylink-missing" href="NaN.html">NaN</a> 数据的处理更友好，不会返回 <a class="tc-tiddlylink tc-tiddlylink-missing" href="NaN.html">NaN</a></p></li></ul><h2>介绍了 1 个可视化工具：</h2><ul><li><p><a href="https://matplotlib.org/" target="_blank">Matplotlib</a>：跟上面的几个都合得来</p><ul><li><p><a href="https://matplotlib.org/users/index.html" target="_blank">official User’s Guide</a></p></li></ul></li></ul><h2>样本和总体</h2><p>在计算方差等方法时，得注意区分是样本还是总体，因为有个问题 <a href="https://www.zhihu.com/question/20099757" target="_blank">为什么样本方差（sample variance）的分母是 n-1？ - 知乎</a></p><p>python 的几个包中都有这方面的处理：</p><p>比如：</p><ul><li><p>statistics:</p><ul><li><p><a href="https://docs.python.org/3/library/statistics.html#statistics.pvariance" target="_blank">总体方差 statistics.pvariance()</a></p></li><li><p>样本方差：statistics.variance()</p></li></ul></li><li><p><a class="tc-tiddlylink tc-tiddlylink-missing" href="NumPy.html">NumPy</a> or Pandas：</p><ul><li><p>总体方差：parameter ddof=0</p></li></ul></li></ul><h2>数据集中包含 <a href="https://en.wikipedia.org/wiki/NaN" target="_blank">not-a-number value (nan)</a></h2><p>我从文章一路看下来，感觉 scipy 和 pandas 对 nan 的容忍度比较高，通常会忽略这些值，返回需要的结果，而其他包则经常返回 nan。</p><h2>打包获取所有的统计量</h2><p>scipy 和 pandas 提供了这种 describe 方法：</p><ul><li><p><a href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.stats.describe.html" target="_blank">scipy.stats.describe()</a></p></li><li><p><a href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.Series.describe.html" target="_blank">pandas series .describe()</a></p></li></ul><p>一次性返回包含所有统计量的结果集，很是方便，不用一个一个单独的方法调用了。</p><p>Numpy 是否也有类似的，作者没有提到，待查。</p><h1>感悟</h1><p>开始看的时候兴致勃勃准备跟着一起录一遍代码，后来发现，数学基础不行，很多基本概念不清，光知道调用什么函数方法没啥帮助，所以还是边看边捋了一遍基本概念。</p><h1>基本概念学习</h1><h2>单一数据集：</h2><p>算术平均数：最简单易懂，但容易受 outliers 影响<br>中位数：可以消除 outliers 影响</p><h3>平均数</h3><p>通常多有简单和加权</p><p><strong>- 算术平均数：</strong> 这个都熟悉的，数据集中的所有数之和/总数</p><ul><li><p><strong>加权平均数：</strong> Σᵢ(𝑤ᵢ𝑥ᵢ) / Σᵢ𝑤ᵢ.</p><p>了解这个概念的时候，让我终于理解了 <a href="https://realpython.com/python-zip-function/" target="_blank">Using the Python zip() Function</a> 。zip 就是拉链，把 𝑤ᵢ 和 𝑥ᵢ 交织在一起，有意思。</p></li></ul><p><strong>- 几何平均数</strong>：ⁿ√(Πᵢ𝑥ᵢ)</p><ul><li><p><strong>应用场景：</strong>感谢<a href="https://www.zhihu.com/question/36176004/answer/139623544" target="_blank">几何平均数的空间意义是什么啊？ - 成长的回答 - 知乎</a> -&gt; <a href="https://www.mathsisfun.com/numbers/geometric-mean.html" target="_blank">Math is Func</a></p><ul><li><p>比较几种物质或事情，他们的一些特征属性之间差别比较大</p></li><li><p>比如：比较照相机的性能，放大倍数 200 和视野 8，前者是后者的几倍数</p><ul><li><p>如果用算数平均数，outliers 影响比较大</p></li></ul></li><li><p>几何平均数会消除这些看似 Outliers 的影响</p></li></ul></li></ul><p><strong>- 倒数平均数（Harmonic mean)：</strong></p><ul><li><p>数据集中的每个数先取倒数</p></li><li><p>然后求和</p></li><li><p>然后求算术平均数</p></li><li><p>然后再求倒数</p></li></ul><p><strong>公式</strong>： 𝑛 / Σᵢ(1/𝑥ᵢ)</p><p><strong>一个经典的应用：</strong>在距离相等的情况下，求平均速度。比如你从家到公司，再从公司到家。但如果你走了不同的路线，就得考虑加权调和了。</p><p><strong>其他应用：</strong></p><ul><li><p>机器学习里面，F1</p></li><li><p>求利率，费率</p></li></ul><p><strong>原理：</strong></p><ul><li><p>距离相等的情况下，速度不同，用时便不同；</p></li><li><p>因此，平均速度会偏向用时比较少的那个速度</p></li><li><p>所以，算术平均数在这里不够准确</p><ul><li><p>它是以速度（公里/小时）为基数，未考虑用时的偏移</p></li><li><p>用时间作为权重，即加权平均数可以得到准确的平均速度</p></li></ul></li><li><p>倒数平均数则是反过来</p><ul><li><p>以用时（小时/公里）来计算，</p></li></ul></li></ul><p><strong>启发：</strong></p><ul><li><p>反过来想，反过来想</p></li></ul><h3>中位数</h3><p>位于数据集中间的数，</p><ul><li><p>奇数个：0.5*(n+1)</p></li><li><p>偶数个：0.5<em>n, 0.5</em>n+1</p></li></ul><p>它和平均数的主要区别在于 outliers，就是一些特别大的或者特别小的数据，这些数据对中位数的计算影响不大，而平均数则很受影响。</p><p>现实中可记得，很多大赛，在计分的时候，都会“去掉一个最高分，再去掉一个最低分，选手的最终得分是 XXX”。这个最高分和最低分就是 Outliers。</p><h3>Mode</h3><p>出现最多的数。这个比较简单。</p><h2>方差，标准差，协方差</h2><p>// TODO</p><h1>可视化</h1><h2>数据源</h2><p>2D 数据，带标签或不带标签 （头）</p><p>Numpy-: `np.array([...])</p><p>Pandas：<code>pd.DataFrame(a, index=row_names, columns=col_names)</code></p><p>可以用 <a href="https://docs.scipy.org/doc/numpy-1.16.0/reference/routines.random.html" target="_blank">np.random</a> 生成一些样本数据，快速试验。</p><h2>呈现样式图</h2><ul><li><p>Box plots</p></li><li><p>Histograms</p></li><li><p>Pie charts</p></li><li><p>Bar charts</p></li><li><p>X-Y plots</p></li><li><p>Heatmaps</p></li></ul><p>具体视需求而定，每种图都有不同的数据输入要求。</p><h2>工具</h2><pre><code>&gt;&gt;&gt; import matplotlib.pyplot as plt
&gt;&gt;&gt; plt.style.use('ggplot')
</code></pre><p>基本就是类似以下三步：再加上一些坐标轴、样例等</p><pre><code>fig, ax = plt.subplots()
ax.boxplot((x, y, z), vert=False, showmeans=True, meanline=True,
           labels=('x', 'y', 'z'), patch_artist=True,
           medianprops={'linewidth': 2, 'color': 'purple'},
           meanprops={'linewidth': 2, 'color': 'red'})
plt.show()

</code></pre><h2>扩展</h2><p>关于可视化，还有其他工具：</p><ul><li><p><a href="https://realpython.com/python-data-visualization-bokeh/" target="_blank">Interactive Data Visualization in Python With Bokeh</a></p></li><li><p><a href="https://plot.ly/" target="_blank">Dash</a></p></li><li><p>...</p></li></ul><h1>参考</h1><ul><li><p><a href="https://en.wikipedia.org/wiki/Harmonic_mean" target="_blank">harmonic mean</a></p></li><li><p><a href="https://www.zhihu.com/question/23096098/answer/863684743" target="_blank">如何理解与应用调和平均数？ - 知乎</a></p></li><li><p><a href="https://www.mathsisfun.com/numbers/geometric-mean.html" target="_blank">非常有意思 geometric mean</a></p></li><li><p><a href="http://blog.sina.com.cn/s/blog_672c5a470100miqq.html" target="_blank">关于协方差矩阵的概念及意义</a></p></li></ul><h2><a class="tc-tiddlylink tc-tiddlylink-missing" href="ChangeLog.html">ChangeLog</a></h2><ul><li><p>2020-01-02 init</p></li></ul></div>



</div>

</p>
</section>
</body>
</html>
